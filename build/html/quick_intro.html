

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quick Intro to Behat &mdash; Behat v1.1.0 documentation</title>
    <link rel="stylesheet" href="_static/scrolls.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/behat.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lobster" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="Behat v1.1.0 documentation" href="index.html" />
    <link rel="next" title="Gherkin DSL" href="gherkin/index.html" />
    <link rel="prev" title="Behat Documentation" href="index.html" /> 
  </head>
  <body>
    <header>
        <a id="logo" href="http://behat.org">Behat</a>
        <nav>
            <ul>
                <li><a href="http://behat.org">main</a></li>
                <li class="active"><a href="http://docs.behat.org">docs</a></li>
                <li><a href="http://pear.behat.org">pear</a></li>
                <li><a href="https://github.com/Behat">github</a></li>
            </ul>
        </nav>
    </header>

    <section class="docs">

        <nav class="toc">
            <h3>Navigation</h3>
            <ul class="nav">
                <li><a href="index.html">Behat Documentation</a></li>
                    <li>
                        <a href="#">
                            Quick Intro to Behat
                        </a> (cur)
                    </li>
                    <li><a href="gherkin/index.html">Gherkin DSL</a> (next)</li>
            </ul>

            <h3>Table Of Contents</h3>
            <ul>
<li><a class="reference internal" href="#">Quick Intro to Behat</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#feature">Feature</a></li>
<li><a class="reference internal" href="#step-definition">Step Definition</a></li>
<li><a class="reference internal" href="#environment">Environment</a></li>
<li><a class="reference internal" href="#cli">CLI</a></li>
</ul>
</li>
</ul>

        </nav>

        <section class="documentation">
            
  <div class="section" id="quick-intro-to-behat">
<h1>Quick Intro to Behat<a class="headerlink" href="#quick-intro-to-behat" title="Permalink to this headline">¶</a></h1>
<p>Behat is an <a class="reference external" href="http://creativecommons.org/licenses/MIT/">open source</a> <a class="reference external" href="http://en.wikipedia.org/wiki/Behavior_Driven_Development">behavior driven development</a> framework for php 5.3.</p>
<p>Behat was inspired by Ruby&#8217;s <a class="reference external" href="http://cukes.info/">Cucumber</a> project and especially it&#8217;s syntax part (Gherkin). It tries to be like Cucumber with input (Feature files) and output (console formatters), but in core, it built from the ground on the shoulders of giants:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/symfony/DependencyInjection">Symfony Dependency Injection Container component</a></li>
<li><a class="reference external" href="https://github.com/symfony/EventDispatcher">Symfony Event Dispatcher component</a></li>
<li><a class="reference external" href="https://github.com/symfony/Console">Symfony Console component</a></li>
<li><a class="reference external" href="https://github.com/symfony/Finder">Symfony Finder component</a></li>
<li><a class="reference external" href="https://github.com/symfony/Translation">Symfony Translation component</a></li>
</ul>
<p>Unlike any other php testing framework that tests applications inside out. Behat is testing applications <a class="reference external" href="http://blog.dannorth.net/whats-in-a-story/">outside in</a>. It means, that Behat works only with your application&#8217;s input/output. If you want to test your models - use unit testing framework instead, Behat created for behavior testing (but can be used for anything +) ).</p>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>There&#8217;s many ways to install Behat to your system, but first, check first and only requirement of it: you must have php 5.3.1+ installed. If you have - continue reading, if not - install it first.</p>
<p>The simpliest way to install it through PEAR:</p>
<div class="highlight-bash"><div class="highlight"><pre>pear channel-discover pear.behat.org
pear install behat/gherkin
pear install behat/behat
</pre></div>
</div>
<p>You can also clone the project with Git by running:</p>
<div class="highlight-bash"><div class="highlight"><pre>git clone git://github.com/Behat/Behat.git <span class="o">&amp;&amp;</span> <span class="nb">cd </span>Behat
git submodule update --init
</pre></div>
</div>
<p>After downloading - just run <tt class="docutils literal"><span class="pre">path/to/Behat/bin/behat</span></tt> or simply <tt class="docutils literal"><span class="pre">behat</span></tt> (if you installed Behat through PEAR) from console.</p>
</div>
<div class="section" id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>Behat is a tool that can execute plain-text functional descriptions as automated tests. The language that Behat (and Ruby Cucumber) understands is called Gherkin. Here is an example:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Search courses</span>
<span class="nf">  In order to ensure better utilization of courses</span>
<span class="nf">  Potential students should be able to search for courses</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Search by topic</span>
<span class="k">    Given </span><span class="nf">there are </span><span class="s">240</span><span class="nf"> courses which do not have the topic &quot;</span><span class="s">biology</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">And </span><span class="nf">there are </span><span class="s">2</span><span class="nf"> courses A</span><span class="s">001</span><span class="nf">, B</span><span class="s">205</span><span class="nf"> that each have &quot;</span><span class="s">biology</span><span class="nf">&quot; as one of the topics</span>
<span class="nf">    </span><span class="k">When </span><span class="nf">I search for &quot;</span><span class="s">biology</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Then </span><span class="nf">I should see the following courses:</span>
<span class="k">      |</span><span class="s"> Course code</span><span class="k"> |</span><span class="nf"></span>
<span class="k">      |</span><span class="s"> A001</span><span class="k">        |</span><span class="nf"></span>
<span class="k">      |</span><span class="s"> B205</span><span class="k">        |</span>
</pre></div>
</div>
<p>While Behat can be thought of as a “testing” tool, the intent of the tool is to support BDD. This means that the “features” (plain text descriptions with scenarios) are typically written before anything else and verified by business analysts, domain experts, etc. non technical stakeholders. The production code is then written outside in, to make the stories pass.</p>
<p>The basic Behat test environment directory looks like this:</p>
<div class="highlight-bash"><div class="highlight"><pre>|-- features
   <span class="sb">`</span>-- steps
   |   <span class="sb">`</span>-- math_steps.php
   <span class="sb">`</span>-- support
       |-- bootstrap.php
       |-- env.php
</pre></div>
</div>
<p>And it can be splitted into 3 main areas:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">features</span></tt> - root test directory. Feature files are placed here.</li>
<li><tt class="docutils literal"><span class="pre">features/steps</span></tt> - step definitions directory. Step definitions (php scripts) lay here.</li>
<li><tt class="docutils literal"><span class="pre">features/support</span></tt> - support directory. Support scripts (environment, path definition) created here.</li>
</ol>
<p>Core of the tests in Behat is features. Features are placed in <tt class="docutils literal"><span class="pre">features</span></tt> directory and are plain text files.</p>
<p>Behat parses feature files and tries to find appropriate step definition for each step from <tt class="docutils literal"><span class="pre">features/steps</span></tt> folder (step definitions path).</p>
<p>Every step definition is simple php-callable with access to shared between batch steps (scenarios) environment object, that can be configured inside <tt class="docutils literal"><span class="pre">features/support/env.php</span></tt>.</p>
<p>And if environment config requires some libraries to work (PHPUnit for example) - includes are placed inside <tt class="docutils literal"><span class="pre">features/support/bootstrap.php</span></tt>.</p>
</div>
<div class="section" id="feature">
<h2>Feature<a class="headerlink" href="#feature" title="Permalink to this headline">¶</a></h2>
<p>Feature file is your Behat entry point. That&#8217;s where you start working on your project. Here&#8217;s content of basic feature <tt class="docutils literal"><span class="pre">features/math.feature</span></tt>:</p>
<div class="highlight-gherkin"><div class="highlight"><pre><span class="k">Feature:</span><span class="nf"> Addition</span>
<span class="nf">  In order to avoid silly mistakes</span>
<span class="nf">  As a math idiot</span>
<span class="nf">  I want to be told the sum of two numbers</span>

<span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Add two numbers</span>
<span class="k">    Given </span><span class="nf">I have entered </span><span class="s">50</span><span class="nf"> into the calculator</span>
<span class="nf">      </span><span class="k">And </span><span class="nf">I have entered </span><span class="s">70</span><span class="nf"> into the calculator</span>
<span class="nf">     </span><span class="k">When </span><span class="nf">I press add</span>
<span class="nf">     </span><span class="k">Then </span><span class="nf">The result should be </span><span class="s">120</span><span class="nf"> on the screen</span>
</pre></div>
</div>
<p>As you can see, feature is a simple, readable plain text file. Every feature is written in <a class="reference external" href="http://en.wikipedia.org/wiki/Domain-specific_language">DSL</a> called <strong>Gherkin</strong>, that firstly was introduced in Ruby&#8217;s <a class="reference external" href="http://cukes.info/">Cucumber</a>.</p>
<ol class="arabic simple">
<li>every <tt class="docutils literal"><span class="pre">*.feature</span></tt> file conventionally consists of single feature.</li>
<li>line starting with keyword <tt class="docutils literal"><span class="pre">Feature:</span></tt> (or localized one) followed by free indented text starts a feature.</li>
<li>feature usually contains a list of scenarios. You can write whatever you want up until the first scenario and this text will become feature description.</li>
<li>every scenario starts from <tt class="docutils literal"><span class="pre">Scenario:</span></tt> or <tt class="docutils literal"><span class="pre">Scenario</span> <span class="pre">Outline:</span></tt> keywords (or localized equivalent). Each scenario consists of steps, which must start with one of the <tt class="docutils literal"><span class="pre">Given</span></tt>, <tt class="docutils literal"><span class="pre">When</span></tt>, <tt class="docutils literal"><span class="pre">Then</span></tt>, <tt class="docutils literal"><span class="pre">But</span></tt> or <tt class="docutils literal"><span class="pre">And</span></tt> keywords (or localized one). Behat treats all this step types the same, but you shouldn’t!</li>
</ol>
</div>
<div class="section" id="step-definition">
<h2>Step Definition<a class="headerlink" href="#step-definition" title="Permalink to this headline">¶</a></h2>
<p>For each step Behat will look for a matching step definition. A step definition is written in php. Each step definition consists of a keyword, a regular expression, and a callback. Example <tt class="docutils literal"><span class="pre">features/steps/math.php</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nv">$steps</span><span class="o">-&gt;</span><span class="na">Given</span><span class="p">(</span><span class="s1">&#39;/^I have entered (\d+) into the calculator$/&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$world</span><span class="p">,</span> <span class="nv">$arg1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Behat\Behat\Exception\Pending</span><span class="p">(</span><span class="s1">&#39;Write code later&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">$steps</span></tt> is a global DefinitionDispatcher object, available in all step definition files. Calling <tt class="docutils literal"><span class="pre">-&gt;Given</span></tt> on it will define new <tt class="docutils literal"><span class="pre">Given</span></tt> (but this will match <tt class="docutils literal"><span class="pre">When</span></tt>/<tt class="docutils literal"><span class="pre">Then</span></tt>/<tt class="docutils literal"><span class="pre">And</span></tt> keyworded steps too) step.</li>
<li><tt class="docutils literal"><span class="pre">'/^I</span> <span class="pre">have</span> <span class="pre">entered</span> <span class="pre">(\d+)</span> <span class="pre">into</span> <span class="pre">the</span> <span class="pre">calculator$/'</span></tt> - regex matcher for step. All search patterns (<tt class="docutils literal"><span class="pre">(\d+)</span></tt>) will become callback arguments (<tt class="docutils literal"><span class="pre">$arg1</span></tt>).</li>
<li>First callback argument (<tt class="docutils literal"><span class="pre">$world</span></tt>) is always reserved for environment object. Environment object created before every scenario run and shared between scenario steps.</li>
<li>Step definition body is simple php code. <strong>Failed</strong> step is a step, which definition execution throws an exception. So, if step execution doesn&#8217;t throw exceptions - step <strong>passes</strong>.</li>
</ol>
</div>
<div class="section" id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Permalink to this headline">¶</a></h2>
<p>Behat creates environment object for each scenario and passes reference to it into each step definition.</p>
<p>So, if you want to calculate/accumulate or just share variables between steps definitions - use <tt class="docutils literal"><span class="pre">$world</span></tt> container for that.</p>
<p>But what if you need some definitions being connected in each world? Use environment configurator for that:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="c1">// features/support/env.php</span>

<span class="k">require</span> <span class="s1">&#39;paths.php&#39;</span><span class="p">;</span>

<span class="c1">// Create WebClient behavior</span>
<span class="nv">$world</span><span class="o">-&gt;</span><span class="na">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Goutte\Client</span><span class="p">;</span>
<span class="nv">$world</span><span class="o">-&gt;</span><span class="na">response</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="nv">$world</span><span class="o">-&gt;</span><span class="na">form</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>

<span class="c1">// Helpful closures</span>
<span class="nv">$world</span><span class="o">-&gt;</span><span class="na">visit</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="nv">$link</span><span class="p">)</span> <span class="k">use</span><span class="p">(</span><span class="nv">$world</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$world</span><span class="o">-&gt;</span><span class="na">response</span> <span class="o">=</span> <span class="nv">$world</span><span class="o">-&gt;</span><span class="na">client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nv">$link</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This file will be executed on each environment object creation. <tt class="docutils literal"><span class="pre">$world</span></tt> variable is an environment object itself, which works like variable holder for all your scenario values &amp; parameters.</p>
<p>But what if we need to use some 3rd party libraries in <tt class="docutils literal"><span class="pre">env.php</span></tt>? It&#8217;s unefficient to require them before each scenario, so Behat has bootstrapping script support:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="c1">// features/support/bootstrap.php</span>

<span class="k">require_once</span> <span class="s1">&#39;PHPUnit/Autoload.php&#39;</span><span class="p">;</span>
<span class="k">require_once</span> <span class="s1">&#39;PHPUnit/Framework/Assert/Functions.php&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>This file will be evaluated by Behat before feature tests even run ;-)</p>
</div>
<div class="section" id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Permalink to this headline">¶</a></h2>
<p>Behat comes bundled with powerfull console runner, called... behat.</p>
<p>To see current Behat version, run:</p>
<div class="highlight-bash"><div class="highlight"><pre>behat -V
</pre></div>
</div>
<p>To see other available commands, use:</p>
<div class="highlight-bash"><div class="highlight"><pre>behat -h
</pre></div>
</div>
<p>Now you know all you need to get started with Behat. You can start using BDD in your projects right now or continue to read full guide.</p>
</div>
</div>


        </section>

        <footer>
            <nav>
                    &laquo; <a href="index.html">Behat Documentation</a> |
                    <a href="#">
                        Quick Intro to Behat
                    </a>
                    | <a href="gherkin/index.html">Gherkin DSL</a> &raquo;
            </nav>
        </footer>

    </section>

    <footer>
        <dl>
            <dt>Docs</dt>
            <dd><a href="http://docs.behat.org/en/quick_intro.html">Quick Intro</a></dd>
            <dd><a href="http://docs.behat.org/en/index.html">Behat</a></dd>
            <dd><a href="http://docs.behat.org/api/gherkin/index.html">Gherkin API</a></dd>
            <dd><a href="http://docs.behat.org/api/behat/index.html">Behat API</a></dd>
        </dl>
        <dl>
            <dt>Plugins</dt>
            <dd><a href="http://symfony2bundles.org/Behat/BehatBundle">BehatBundle</a></dd>
            <dd><a href="https://github.com/Behat/sfBehatPlugin">sfBehatPlugin</a></dd>
        </dl>
        <dl>
            <dt>Pear</dt>
            <dd><a href="http://pear.everzet.com/">Gherkin</a></dd>
            <dd><a href="http://pear.everzet.com/">Behat</a></dd>
        </dl>
        <dl>
            <dt>GitHub</dt>
            <dd><a href="https://github.com/Behat/Gherkin">Gherkin</a></dd>
            <dd><a href="https://github.com/Behat/Behat">Behat</a></dd>
        </dl>

        <div class="clear"></div>

        <div class="sponsor">
            <span>sponsored by</span>
            <a class="knp" href="http://www.knplabs.com">knpLabs, Symfony developers</a>
        </div>
    </footer>

  </body>
</html>